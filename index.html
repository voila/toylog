<html>
<head></head>
<style>
#msg { border: 1px solid red;}

</style>
<script src="solve.js"></script>
<script src="parser.js"></script>
<script src="jquery.js"></script>

<script>

    var parse = PARSER.parse;
    //var assert = chai.assert;

    // used to display different solutions incrementally
    function displaySol(str){
      $("#msg").append(str + "<br />");
    }

    function nextSol(){
      return confirm("Next Solution?");
    }
    function ask(){
      try {
        var p = parse($("#prog").val()).clauses;
        var g = parse($("#query").val()).clauses[0][0];
        $("#msg").empty();
        var s = solve(g, p, displaySol, nextSol);
        $("#msg").append(s ? 'Yes' : 'No');
      }
      catch(e){
       $("#msg").html(e.toString());
       //console.log(e.toString());
      }
    }


    var examples = {
       append : { 
         prog: [
            ["append(nil,L,L).\n"],
            ["append(cons(H,L1),L2,cons(H,L3)) :- append(L1,L2,L3).\n"]
         ],
         query: "append(cons(a,cons(b,nil)),cons(c,cons(d,nil)),Y).\n"
       },
       gods : {
         prog: [
            ["mother(gaia,cronos).\n"],
            ["mother(rhea,zeus).\n"],
            ["mother(rhea,hades).\n"],
            ["father(zeus,pollux).\n"],
            ["father(cronos,zeus).\n"],
            ["father(ouranos,cronos).\n"],
            ["father(zeus,helene).\n"],
            ["father(zeus,castor).\n"],
            ["parent(X,Y) :- father(X,Y).\n"],
            ["parent(X,Y) :- mother(X,Y).\n"],
            ["grandparent(X,Z) :- parent(X,Y),parent(Y,Z).\n"]
         ],
         query: ["grandparent(cronos,X).\n"]
       }
    }

    // UI handlers
    $(function(){
       $("#ask").click(ask);

       $("#examples").on('change', function() {
           $("#prog").html(examples[this.value].prog);
           $("#query").html(examples[this.value].query);
       });
    });

</script>
<body>

<p>
<select id="examples">
    <option value="append">append</option>
    <option value="gods">gods</option>
</select>
</p>

<textarea id="prog" rows="15" cols="55">
append(nil,L,L).
append(cons(H,L1),L2,cons(H,L3)) :- append(L1,L2,L3).

</textarea>

<br />
<textarea id="query" rows="5" cols="55">
append(cons(a,cons(b,nil)),cons(c,cons(d,nil)),Y).

</textarea>
<p><button id="ask">Ask</button></p>

<p id="msg"></p>

</body>
